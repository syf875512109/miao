<script>
  var ANCESTRY_FILE = `[
  {"name": "Carolus Haverbeke", "sex": "m", "born": 1832, "died": 1905, "father": "Carel Haverbeke", "mother": "Maria van Brussel"},
  {"name": "Emma de Milliano", "sex": "f", "born": 1876, "died": 1956, "father": "Petrus de Milliano", "mother": "Sophia van Damme"},
  {"name": "Maria de Rycke", "sex": "f", "born": 1683, "died": 1724, "father": "Frederik de Rycke", "mother": "Laurentia van Vlaenderen"},
  {"name": "Jan van Brussel", "sex": "m", "born": 1714, "died": 1748, "father": "Jacobus van Brussel", "mother": "Joanna van Rooten"},
  {"name": "Philibert Haverbeke", "sex": "m", "born": 1907, "died": 1997, "father": "Emile Haverbeke", "mother": "Emma de Milliano"},
  {"name": "Jan Frans van Brussel", "sex": "m", "born": 1761, "died": 1833, "father": "Jacobus Bernardus van Brussel", "mother":null},
  {"name": "Pauwels van Haverbeke", "sex": "m", "born": 1535, "died": 1582, "father": "N. van Haverbeke", "mother":null},
  {"name": "Clara Aernoudts", "sex": "f", "born": 1918, "died": 2012, "father": "Henry Aernoudts", "mother": "Sidonie Coene"},
  {"name": "Emile Haverbeke", "sex": "m", "born": 1877, "died": 1968, "father": "Carolus Haverbeke", "mother": "Maria Sturm"},
  {"name": "Lieven de Causmaecker", "sex": "m", "born": 1696, "died": 1724, "father": "Carel de Causmaecker", "mother": "Joanna Claes"},
  {"name": "Pieter Haverbeke", "sex": "m", "born": 1602, "died": 1642, "father": "Lieven van Haverbeke", "mother":null},
  {"name": "Livina Haverbeke", "sex": "f", "born": 1692, "died": 1743, "father": "Daniel Haverbeke", "mother": "Joanna de Pape"},
  {"name": "Pieter Bernard Haverbeke", "sex": "m", "born": 1695, "died": 1762, "father": "Willem Haverbeke", "mother": "Petronella Wauters"},
  {"name": "Lieven van Haverbeke", "sex": "m", "born": 1570, "died": 1636, "father": "Pauwels van Haverbeke", "mother": "Lievijne Jans"},
  {"name": "Joanna de Causmaecker", "sex": "f", "born": 1762, "died": 1807, "father": "Bernardus de Causmaecker", "mother":null},
  {"name": "Willem Haverbeke", "sex": "m", "born": 1668, "died": 1731, "father": "Lieven Haverbeke", "mother": "Elisabeth Hercke"},
  {"name": "Pieter Antone Haverbeke", "sex": "m", "born": 1753, "died": 1798, "father": "Jan Francies Haverbeke", "mother": "Petronella de Decker"},
  {"name": "Maria van Brussel", "sex": "f", "born": 1801, "died": 1834, "father": "Jan Frans van Brussel", "mother": "Joanna de Causmaecker"},
  {"name": "Angela Haverbeke", "sex": "f", "born": 1728, "died": 1734, "father": "Pieter Bernard Haverbeke", "mother": "Livina de Vrieze"},
  {"name": "Elisabeth Haverbeke", "sex": "f", "born": 1711, "died": 1754, "father": "Jan Haverbeke", "mother": "Maria de Rycke"},
  {"name": "Lievijne Jans", "sex": "f", "born": 1542, "died": 1582, "father":null, "mother":null},
  {"name": "Bernardus de Causmaecker", "sex": "m", "born": 1721, "died": 1789, "father": "Lieven de Causmaecker", "mother": "Livina Haverbeke"},
  {"name": "Jacoba Lammens", "sex": "f", "born": 1699, "died": 1740, "father": "Lieven Lammens", "mother": "Livina de Vrieze"},
  {"name": "Pieter de Decker", "sex": "m", "born": 1705, "died": 1780, "father": "Joos de Decker", "mother": "Petronella van de Steene"},
  {"name": "Joanna de Pape", "sex": "f", "born": 1654, "died": 1723, "father": "Vincent de Pape", "mother": "Petronella Wauters"},
  {"name": "Daniel Haverbeke", "sex": "m", "born": 1652, "died": 1723, "father": "Lieven Haverbeke", "mother": "Elisabeth Hercke"},
  {"name": "Lieven Haverbeke", "sex": "m", "born": 1631, "died": 1676, "father": "Pieter Haverbeke", "mother": "Anna van Hecke"},
  {"name": "Martina de Pape", "sex": "f", "born": 1666, "died": 1727, "father": "Vincent de Pape", "mother": "Petronella Wauters"},
  {"name": "Jan Francies Haverbeke", "sex": "m", "born": 1725, "died": 1779, "father": "Pieter Bernard Haverbeke", "mother": "Livina de Vrieze"},
  {"name": "Maria Haverbeke", "sex": "m", "born": 1905, "died": 1997, "father": "Emile Haverbeke", "mother": "Emma de Milliano"},
  {"name": "Petronella de Decker", "sex": "f", "born": 1731, "died": 1781, "father": "Pieter de Decker", "mother": "Livina Haverbeke"},
  {"name": "Livina Sierens", "sex": "f", "born": 1761, "died": 1826, "father": "Jan Sierens", "mother": "Maria van Waes"},
  {"name": "Laurentia Haverbeke", "sex": "f", "born": 1710, "died": 1786, "father": "Jan Haverbeke", "mother": "Maria de Rycke"},
  {"name": "Carel Haverbeke", "sex": "m", "born": 1796, "died": 1837, "father": "Pieter Antone Haverbeke", "mother": "Livina Sierens"},
  {"name": "Elisabeth Hercke", "sex": "f", "born": 1632, "died": 1674, "father": "Willem Hercke", "mother": "Margriet de Brabander"},
  {"name": "Jan Haverbeke", "sex": "m", "born": 1671, "died": 1731, "father": "Lieven Haverbeke", "mother": "Elisabeth Hercke"},
  {"name": "Anna van Hecke", "sex": "f", "born": 1607, "died": 1670, "father": "Paschasius van Hecke", "mother": "Martijntken Beelaert"},
  {"name": "Maria Sturm", "sex": "f", "born": 1835, "died": 1917, "father": "Charles Sturm", "mother": "Seraphina Spelier"},
  {"name": "Jacobus Bernardus van Brussel", "sex": "m", "born": 1736, "died": 1809, "father": "Jan van Brussel", "mother": "Elisabeth Haverbeke"}
]`

  function filter(array, test) {
    let passed = [];
    for(let i = 0; i < array.length; i++) {
      if (test(array[i], i, array)) {
        passed.push(array[i]);
      }
    }
    return passed;
  }

  function map(array, transform) {
    let mapper = [];
    for(let i = 0; i < array.length; i++) {
      mapper.push(transform(array[i]));
    }

    return mapper;
  }

  let ansestor = JSON.parse(ANCESTRY_FILE);

  function reduce(array, handle, start) {
    let current = start;
    let begin = 0;

    if (start == undefined) {
      current = array[0];
      begin = 1;
    }
    for (let i = begin; i < array.length; i++) {
      current = handle(current, array[i], i, array);
    }
    return current;
  }

  let manCount = 0;
  let womanCount = 0;
  let sumMan = 0;
  let sumWoman = 0;
  function average(array) {
    let manCount = 0;
    let womanCount = 0;
    let sumMan = 0;
    let sumWoman = 0;

    for (let i = 0; i < array.length; i++) {
      if (array[i].sex == "m") {
        manCount++;
        sumMan += (array[i].died - array[i].born);
      }else {
        womanCount++;
        sumWoman += (array[i].died - array[i].born);
      }
    }
    console.log((sumMan / manCount).toFixed(2), (sumWoman / womanCount).toFixed(2));
  }
  
  function aver(array) {
    let sum = 0;
    sum = array.reduce( (x, y) => x + y);
    return sum / array.length;
  }
  // debugger;
  function bind(f, omit, ...rest) {
    return function(...args) {
      return f(...rest, ...args);
    }
  };

  function sumTwo(a, b) {
    return a + b;
  }
  
  let theSet = ["Carel Haverbeke", "Maria van Brussel", "Donald Duck"];
  function isIntheSet(set, person) {
    return set.includes(person.name);
  }
  // console.log(ansestor.filter((person) => {
  //   return isIntheSet(theSet, person);
  // }));
  // console.log(ansestor.filter(isIntheSet.bind(null, theSet)));
  function forEach(arr, action) {
    for (let i = 0; i < arr.length; i++) {
      action(arr[i]);
    }
  }

  let arr = ["Wampeter", "Foma", "Granfalloon"];

  

  function gatherCorrelations(journal) {
    var phis = {};
    journal.forEach(entrys => {
      entrys.events.forEach(event => {
        if (!(event in phis)) {
          phis[event] = phi(tableFor(event, journal));
        }
      });
    });
    return phis;
  }

  function greaterThan(n) {
    return function(m) {
      return m > n;
    }
  }

  function noisy(f) {
    return function() {
      console.log("calling with " ,arguments);
      var samp = f.apply(null, arguments);
      console.log("called with", arguments, " - got", samp);
      return samp;
    };
  }

  function unless(test, then) {
    if (!test) {
      then();
    }
  }

  function repeat(times, body) {
    for(let i = 0; i < times; i++) {
      body(i);
    }
  }

  
  function flatten(array, count = 1) {
    let arr = [],
        current;
    let depth = 0;
    array.forEach(num => {
      if (Array.isArray(num)) {
        depth++;
        num.forEach(n => {
          arr.push(n);
        })
      }else {
        arr.push(num);
      }
    })
    return arr;
  }

  function flattenDepth(array, depth = 1) {
    let result = [];
    if (depth < 1) {
      return array;
    }
    for (let val of array) {
      if (Array.isArray(val)) {
        result.push(...flattenDepth(val, depth - 1));
      }else {
        result.push(val);
      }
    }
    return result;
  }
  function Node(val) {
    this.val = val;
    this.left = null;
    this.right = null;
  }
  function ary2Tree(ary, rootPos = 0) {
    if (rootPos >= ary.length || ary[rootPos] == null) {
      return null;
    }
    let newNode = new Node(ary[rootPos]);
    newNode.left = ary2Tree(ary, rootPos * 2 + 1);
    newNode.right = ary2Tree(ary, rootPos * 2 + 2);

    return newNode;
  }

  function tree2ary(root, result = [], rootPos = 0) {
    if (!root) {
      result.push(null);
      return;
    }
    result[rootPos] = root.val;
    tree2ary(root.left, result, 2 * rootPos + 1);
    tree2ary(root.right, result, rootPos * 2 + 2);
    return result;
  }

  function ary2TreeLc(ary) {
    let queue = [new Node(ary[0])];
    let index = 0;

    let flag = 0;
    let node;
    for(let i = 1; i < ary.length; i++) {
      if (ary[i] != null) {
        node = new Node(ary[i]);
        queue.push(node);
      }else {
        node = null;
      }
      if (!flag) {
        queue[index].left = node;
        flag = 1;
      }else {
        queue[index].right = node;
        flag = 0;
        index++;
      }
    }

    return queue[0];
  }

  function tree2aryLc(root) {
    if (!root) {
      return [];
    }

    let result = [],
        enqueue = [root];

    let index = 0;
    while(index < enqueue.length) {
      if (enqueue[index]) {
        result.push(enqueue[index].val);
        enqueue.push(enqueue[index].left);
        enqueue.push(enqueue[index].right);
      }else {
        result.push(null);
      }
      index++;
    }
    return result;
  }

  function preOrderTranverse(root) {
    if (root) {
      console.log(root.val);
      preOrderTranverse(root.left);
      preOrderTranverse(root.right);
    }
  }

  function inOrderTranverse(root, action = console.log) {
    if (root) {
      inOrderTranverse(root.left, action);
      action(root.val);
      inOrderTranverse(root.right, action);
    }
  }

  function postOrderTranverse(root) {
    if (root) {
      postOrderTranverse(root.left);
      postOrderTranverse(root.right);
      console.log(root.val);
    }
  }

  function preOrderTranverseDie(root) {
    let result = [root];

    let index = 0;
    let before = 0;
    while(before < result.length) {
      if (result[index].left != null) {
        result.push(result[index].left)
      }else {
        if (result[index].right != null) {
          result.push(result[index].right);
        }
        console.log(result[before++].val);
      }
      index++;
    }
  }

  function insertIntoBST(bst, val) {
    if (!bst) {
      bst = new Node(val);
      return bst;
    }

    if (val < bst.val) {
      bst.left = insertIntoBST(bst.left, val);
    }else {
      bst.right = insertIntoBST(bst.right, val);
    }
    return bst;
  }

  function bstSort(ary) {
    let bst;
    for (let val of ary) {
      bst = insertIntoBST(bst, val);
    }
    // return bst;
    let result = [];

    inOrderTranverse(bst, val => {
      result.push(val);
    });

    return result;
  }

  function mergeSort(ary) {
    if (ary.length < 2) {
      return ary;
    }

    let mid = ary.length >> 1;

    let leftSorted = mergeSort(ary.slice(0, mid));
    let rightSorted = mergeSort(ary.slice(mid));

    let result = [];
    let i = 0, j = 0;
    while(i < leftSorted.length || j < rightSorted.length) {
      if (j >= rightSorted.length || (i < leftSorted.length && leftSorted[i] < rightSorted[j])) {
        result.push(leftSorted[i++]);
      }else {
        result.push(rightSorted[j++])
      }
    }
    return result;
  }
  function swap(ary, start, end) {
    let temp = ary[start];
    ary[start] = ary[end];
    ary[end] = temp;
  }
  function quickSort2(ary, left = 0, right = ary.length - 1) {

    if (left >= right) {
      return;
    }
    let pivotIndex = Math.floor(Math.random() * (right - left + 1) + left);
    let pivo = ary[pivotIndex];

    let temp;
    temp = pivo;
    ary[pivotIndex] = ary[right];
    ary[right] = temp;

    for(var i = left - 1, j = left; j < right; j++) {
      if (ary[j] < pivo) {
        i++;
        temp = ary[i];
        ary[i] = ary[j];
        ary[j] = temp;
      }
    }

    i++;
    temp = ary[i];
    ary[i] = ary[right];
    ary[right] = temp;

    quickSort2(ary, left, i - 1);
    quickSort2(ary, i + 1, right);
    
    return ary;
  }
</script>
